#!/usr/bin/env nu
# SPDX-FileCopyrightText: 2025-present Krys Lawrence <aquarion.5.krystopher@spamgourmet.org>
# SPDX-License-Identifier: AGPL-3.0-only

# Initialize a fresh Devbox
#
# This installs Hatch and pre-commit in an isolated environments.
def "main" []: nothing -> string {
    (
        uv tool install -p $env.AQ_PYTHON_MINIMUM_VERSION --managed-python
        $"hatch~=($env.AQ_HATCH_MINIMUM_VERSION)"
        --with $"pip~=($env.AQ_PIP_MINIMUM_VERSION)"
    )
    (
        uv tool install -p $env.AQ_PYTHON_MINIMUM_VERSION --managed-python
        $"pre-commit~=($env.AQ_PRE_COMMIT_MINIMUM_VERSION)"
    )
    pre-commit install --install-hooks
    (
        uv tool install -p $env.AQ_PYTHON_MINIMUM_VERSION --managed-python
        $"commitizen~=($env.AQ_COMMITIZEN_MINIMUM_VERSION)"
        --with $"cz-conventional-gitmoji~=($env.AQ_CZ_CONVENTIONAL_GITMOJI_MINIMUM_VERSION)"
    )
}
