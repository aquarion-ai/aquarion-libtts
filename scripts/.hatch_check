#!/usr/bin/env nu

# Command run by Hatch scripts. DO NOT RUN DIRECTLY.
def main []: nothing -> string {
    help main
}

let radish_common_args = ["-b", "steps/", "--shuffle", "features/", "-f", "dots"]
let radish_normal_args = ["--tags", "not wip"]
let coverage_args = ["--rcfile=radish_coverage.toml"]

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept" [...rest: string]: nothing -> string {
    radish ...$radish_common_args ...$radish_normal_args ...$rest
}

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept cover" [...rest:string]: nothing -> string  {
    (
        coverage run ...$coverage_args ...(which radish).path ...$radish_common_args
        ...$radish_normal_args ...$rest
    )
    coverage report -m ...$coverage_args
}

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept wip" [...rest: string]: nothing -> string {
    radish ...$radish_common_args --wip --tags wip ...$rest
}
