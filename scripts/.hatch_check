#!/usr/bin/env nu
# SPDX-FileCopyrightText: 2025-present Krys Lawrence <aquarion.5.krystopher@spamgourmet.org>
# SPDX-License-Identifier: AGPL-3.0-only

# Command run by Hatch scripts. DO NOT RUN DIRECTLY.
def main []: nothing -> string {
    help main
}

let radish_common_args = ["-b", "steps/", "features/"]
let radish_normal_args = ["--tags", "not wip", "-f", "dots", "--shuffle"]
let coverage_args = ["--rcfile=radish_coverage.toml"]

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept" [...rest: string]: nothing -> string {
    radish ...$radish_common_args ...$radish_normal_args ...$rest
}

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept cover" [...rest:string]: nothing -> string  {
    (
        coverage run ...$coverage_args ...(which radish).path ...$radish_common_args
        ...$radish_normal_args ...$rest
    )
    coverage report -m ...$coverage_args
}

# Internal command. DO NOT RUN DIRECTLY.
def --wrapped "main accept wip" [...rest: string]: nothing -> string {
    radish ...$radish_common_args --wip --tags wip --write-ids ...$rest
}
